services:
  # Backend API Service (Task 1.1 & 1.2)
  backend:
    build:
      context: ./api
      dockerfile: Dockerfile
    ports:
      - "3000:3000" # Expose port according to architecture
    environment:
      - NODE_ENV=${NODE_ENV:-development}
      - PORT=${PORT:-3000}
      - FRONTEND_URL=${FRONTEND_URL:-http://localhost:5173}
      - MINDX_CLIENT_ID=${MINDX_CLIENT_ID:-mindx-onboarding}
      - MINDX_CLIENT_SECRET=${MINDX_CLIENT_SECRET}

  # Frontend React Service (Task 4.1 & 4.2)
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    ports:
      - "8080:8080" # Expose port according to architecture
    depends_on:
      - backend # Only run Frontend when Backend is ready